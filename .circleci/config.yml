version: 2

defaults: &defaults
  working_directory: /home/circleci/anthem/anthem
  machine:
    image: circleci/classic:latest

default_variables: &default_variables
  ANTHEM_SOURCE_ROOT: /home/circleci/anthem
  ANTHEM_REPO_NAME: anthem

jobs:
  #===----------------------------------------------------------------------===#
  #==- GNU Compiler Collection ----------------------------------------------==#
  #===----------------------------------------------------------------------===#

  #==- C++14 GNU Compiler Collection 5 GLFW ---------------------------------==#

  gcc5_cxx14_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_gcc5_cxx14_glfw
      COMPILER_NAME: gcc
      CXX: g++-5
      CC: gcc-5
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install g++-5 xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 GNU Compiler Collection 5 SDL ----------------------------------==#

  gcc5_cxx14_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_gcc5_cxx14_sdl
      COMPILER_NAME: gcc
      CXX: g++-5
      CC: gcc-5
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install g++-5 xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}



  #==- C++14 GNU Compiler Collection 6 GLFW ---------------------------------==#

  gcc6_cxx14_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_gcc6_cxx14_glfw
      COMPILER_NAME: gcc
      CXX: g++-6
      CC: gcc-6
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install g++-6 xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 GNU Compiler Collection 6 SDL ----------------------------------==#

  gcc6_cxx14_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_gcc6_cxx14_sdl
      COMPILER_NAME: gcc
      CXX: g++-6
      CC: gcc-6
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install g++-6 xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 GNU Compiler Collection 7 GLFW ---------------------------------==#

  gcc7_cxx14_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_gcc7_cxx14_glfw
      COMPILER_NAME: gcc
      CXX: g++-7
      CC: gcc-7
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install g++-7 xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 GNU Compiler Collection 7 SDL ----------------------------------==#

  gcc7_cxx14_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_gcc7_cxx14_sdl
      COMPILER_NAME: gcc
      CXX: g++-7
      CC: gcc-7
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install g++-7 xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++17 GNU Compiler Collection 7 GLFW ---------------------------------==#

  gcc7_cxx17_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_gcc7_cxx17_glfw
      COMPILER_NAME: gcc
      CXX: g++-7
      CC: gcc-7
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install g++-7 xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++17 GNU Compiler Collection 7 SDL ----------------------------------==#

  gcc7_cxx17_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_gcc7_cxx17_sdl
      COMPILER_NAME: gcc
      CXX: g++-7
      CC: gcc-7
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install g++-7 xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}

  #===----------------------------------------------------------------------===#
  #==- Clang ----------------------------------------------------------------==#
  #===----------------------------------------------------------------------===#

  #==- C++14 Clang 3.5 GLFW -------------------------------------------------==#

  clang35_cxx14_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang35_cxx14_glfw
      COMPILER_NAME: clang
      CXX: clang++-3.5
      CC: clang-3.5
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/precise/ llvm-toolchain-precise-3.5 main
        deb-src http://apt.llvm.org/precise/ llvm-toolchain-precise-3.5 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.5 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 3.5 SDL --------------------------------------------------==#

  clang35_cxx14_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang35_cxx14_sdl
      COMPILER_NAME: clang
      CXX: clang++-3.5
      CC: clang-3.5
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/precise/ llvm-toolchain-precise-3.5 main
        deb-src http://apt.llvm.org/precise/ llvm-toolchain-precise-3.5 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.5 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 3.6 GLFW -------------------------------------------------==#

  clang36_cxx14_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang36_cxx14_glfw
      COMPILER_NAME: clang
      CXX: clang++-3.6
      CC: clang-3.6
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.6 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.6 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.6 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 3.6 SDL --------------------------------------------------==#

  clang36_cxx14_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang36_cxx14_sdl
      COMPILER_NAME: clang
      CXX: clang++-3.6
      CC: clang-3.6
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.6 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.6 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.6 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 3.7 GLFW -------------------------------------------------==#

  clang37_cxx14_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang37_cxx14_glfw
      COMPILER_NAME: clang
      CXX: clang++-3.7
      CC: clang-3.7
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.7 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.7 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.7 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 3.7 SDL --------------------------------------------------==#

  clang37_cxx14_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang37_cxx14_sdl
      COMPILER_NAME: clang
      CXX: clang++-3.7
      CC: clang-3.7
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.7 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.7 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.7 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 3.8 GLFW -------------------------------------------------==#

  clang38_cxx14_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang38_cxx14_glfw
      COMPILER_NAME: clang
      CXX: clang++-3.8
      CC: clang-3.8
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.8 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.8 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.8 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 3.8 SDL --------------------------------------------------==#

  clang38_cxx14_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang38_cxx14_sdl
      COMPILER_NAME: clang
      CXX: clang++-3.8
      CC: clang-3.8
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.8 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.8 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.8 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 3.9 GLFW -------------------------------------------------==#

  clang39_cxx14_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang39_cxx14_glfw
      COMPILER_NAME: clang
      CXX: clang++-3.9
      CC: clang-3.9
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.9 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.9 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.9 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 3.9 SDL --------------------------------------------------==#

  clang39_cxx14_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang39_cxx14_sdl
      COMPILER_NAME: clang
      CXX: clang++-3.9
      CC: clang-3.9
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.9 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-3.9 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-3.9 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 4.0 GLFW -------------------------------------------------==#

  clang40_cxx14_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang40_cxx14_glfw
      COMPILER_NAME: clang
      CXX: clang++-4.0
      CC: clang-4.0
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-4.0 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++14 Clang 4.0 SDL --------------------------------------------------==#

  clang40_cxx14_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang40_cxx14_sdl
      COMPILER_NAME: clang
      CXX: clang++-4.0
      CC: clang-4.0
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-4.0 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++17 Clang 4.0 GLFW -------------------------------------------------==#

  clang40_cxx17_glfw:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang40_cxx17_glfw
      COMPILER_NAME: clang
      CXX: clang++-4.0
      CC: clang-4.0
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-4.0 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}


  #==- C++17 Clang 4.0 SDL --------------------------------------------------==#

  clang40_cxx17_sdl:
    <<: *defaults
    environment:
      <<: *default_variables
      ANTHEM_BUILD_PRESET: circleci_linux_clang40_cxx17_sdl
      COMPILER_NAME: clang
      CXX: clang++-4.0
      CC: clang-4.0
    steps:
    - checkout
    - run: sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
    - run: |
        deb http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main
        deb-src http://apt.llvm.org/trusty/ llvm-toolchain-trusty-4.0 main
    - run: sudo apt-get -y update
    - run: sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install clang-4.0 libc++-dev xorg-dev libglu1-mesa-dev build-essential
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        chmod +x $ANTHEM_REPO_NAME/utils/build-script
    - run: ${CC} --version
    - run: ${CXX} --version
    - run: pip install --user requests
    - run: |
        cd $CIRCLE_WORKING_DIRECTORY/..
        $ANTHEM_REPO_NAME/utils/build-script --preset ${ANTHEM_BUILD_PRESET}

workflows:
  version: 2
  build_and_test:
    jobs:
     - gcc48_cxx14_glfw
     - gcc48_cxx14_sdl
     - gcc5_cxx14_glfw
     - gcc5_cxx14_sdl
     - gcc6_cxx14_glfw
     - gcc6_cxx14_sdl
     - gcc7_cxx14_glfw
     - gcc7_cxx14_sdl
     - gcc7_cxx17_glfw
     - gcc7_cxx17_sdl
     - clang35_cxx14_glfw
     - clang35_cxx14_sdl
     - clang36_cxx14_glfw
     - clang36_cxx14_sdl
     - clang37_cxx14_glfw
     - clang37_cxx14_sdl
     - clang38_cxx14_glfw
     - clang38_cxx14_sdl
     - clang39_cxx14_glfw
     - clang39_cxx14_sdl
     - clang40_cxx14_glfw
     - clang40_cxx14_sdl
     - clang40_cxx17_glfw
     - clang40_cxx17_sdl
