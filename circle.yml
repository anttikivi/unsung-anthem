machine:
  environment:
    ANTHEM_BUILD_PRESET: circleci_linux_gcc5_cpp14
    COMPILER_NAME: gcc
    CXX: g++-5
    CC: gcc-5
    ANTHEM_ROOT: /home/ubuntu/unsung-anthem

dependencies:
  pre:
  - sudo apt-add-repository -y "ppa:ubuntu-toolchain-r/test"
  - sudo apt-get -y update
  - sudo apt-get -y --no-install-suggests --no-install-recommends --force-yes install g++-5 xorg-dev libglu1-mesa-dev build-essential
  - chmod +x $ANTHEM_ROOT/utils/build-script
  override:
  - sudo pip install requests
  - cd $ANTHEM_ROOT/.. && unsung-anthem/utils/build-script --preset ${ANTHEM_BUILD_PRESET} --install
  post:
  - ${CC} --version
  - ${CXX} --version

compile:
  override:
  - cd $ANTHEM_ROOT/.. && unsung-anthem/utils/build-script --preset ${ANTHEM_BUILD_PRESET} --build

test:
  override:
  - cd $ANTHEM_ROOT/.. && unsung-anthem/utils/build-script --preset ${ANTHEM_BUILD_PRESET} --run-test
